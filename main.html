<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Placeholder.dev - Advanced Search Dashboard</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        * { font-family: 'Inter', sans-serif; }
        :root {
            --primary-gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --glass-bg: rgba(255, 255, 255, 0.12);
            --glass-border: rgba(255, 255, 255, 0.25);
        }
        body { background: var(--primary-gradient); min-height: 100vh; position: relative; overflow-x: hidden; }
        [data-theme='dark'] body { background: var(--primary-gradient); color: #fff; }
        [data-theme='light'] body { background: #f6f7fb; color: #222; }
        [data-theme='light'] .glass, [data-theme='light'] .btn-secondary, [data-theme='light'] .search-input, [data-theme='light'] .dropdown {
            background: rgba(255,255,255,0.7) !important;
            color: #222 !important;
            border-color: #e0e0e0 !important;
        }
        [data-theme='light'] .glass { box-shadow: 0 12px 40px rgba(180,180,200,0.10); }
        [data-theme='light'] .search-input:focus { background: #fff !important; border-color: #a3a3a3; }
        [data-theme='light'] .dropdown-item, [data-theme='light'] .btn-primary { color: #222 !important; }
        .bg-animation { position: fixed; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; z-index: -1; }
        .floating-orb {
            position: absolute; border-radius: 50%;
            background: linear-gradient(45deg, rgba(255, 255, 255, 0.15), rgba(255, 255, 255, 0.05));
            backdrop-filter: blur(20px); animation: float-smooth 20s infinite ease-in-out;
        }
        .orb-1 { width: 120px; height: 120px; top: 15%; left: 10%; animation-delay: 0s; }
        .orb-2 { width: 200px; height: 200px; top: 50%; right: 15%; animation-delay: -5s; }
        .orb-3 { width: 90px; height: 90px; bottom: 25%; left: 25%; animation-delay: -10s; }
        @keyframes float-smooth {
            0%, 100% { transform: translate(0, 0) scale(1) rotate(0deg); opacity: 0.6; }
            25% { transform: translate(30px, -30px) scale(1.1) rotate(90deg); opacity: 0.8; }
            50% { transform: translate(-20px, 20px) scale(0.9) rotate(180deg); opacity: 0.4; }
            75% { transform: translate(25px, 30px) scale(1.05) rotate(270deg); opacity: 0.7; }
        }
        .glass {
            background: var(--glass-bg); backdrop-filter: blur(25px);
            border: 1px solid var(--glass-border); box-shadow: 0 12px 40px rgba(0, 0, 0, 0.15);
        }
        .btn-primary {
            background: var(--primary-gradient); transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            position: relative; overflow: hidden; border: none;
        }
        .btn-primary:hover { transform: translateY(-3px) scale(1.02); box-shadow: 0 25px 50px rgba(102, 126, 234, 0.5); }
        .btn-secondary {
            background: rgba(255, 255, 255, 0.1); backdrop-filter: blur(15px);
            border: 1px solid rgba(255, 255, 255, 0.2); transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }
        .btn-secondary:hover { background: rgba(255, 255, 255, 0.2); transform: translateY(-2px); }
        .search-input {
            background: rgba(255, 255, 255, 0.15); backdrop-filter: blur(20px);
            border: 2px solid rgba(255, 255, 255, 0.2); transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }
        .search-input:focus {
            background: rgba(255, 255, 255, 0.2); border-color: rgba(255, 255, 255, 0.5);
            box-shadow: 0 0 0 6px rgba(102, 126, 234, 0.2); transform: translateY(-2px);
        }
        .dropdown {
            background: rgba(0, 0, 0, 0.95); backdrop-filter: blur(25px);
            border: 1px solid rgba(255, 255, 255, 0.2); border-radius: 16px;
            box-shadow: 0 25px 50px rgba(0, 0, 0, 0.4); animation: dropdown-appear 0.2s ease;
        }
        @keyframes dropdown-appear { 0% { opacity: 0; transform: translateY(-10px) scale(0.95); } 100% { opacity: 1; transform: translateY(0) scale(1); } }
        .dropdown-item {
            padding: 14px 18px; cursor: pointer; transition: all 0.2s ease;
            display: flex; align-items: center; gap: 14px; color: white; font-size: 14px;
        }
        .dropdown-item:hover { background: rgba(255, 255, 255, 0.15); transform: translateX(4px); }
        .bookmark-item {
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            cursor: pointer; position: relative; overflow: hidden;
        }
        .bookmark-item:hover { transform: translateY(-8px) scale(1.05); box-shadow: 0 20px 40px rgba(0, 0, 0, 0.2); }
        .bookmark-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(180px, 1fr)); gap: 1.5rem; padding: 1rem; }
        .fade-in-up { animation: fade-in-up 0.8s cubic-bezier(0.4, 0, 0.2, 1) forwards; opacity: 0; transform: translateY(30px); }
        @keyframes fade-in-up { to { opacity: 1; transform: translateY(0); } }
        .delay-100 { animation-delay: 0.1s; } .delay-200 { animation-delay: 0.2s; }
        .success-toast { background: linear-gradient(135deg, #10b981 0%, #059669 100%); }
        .error-toast { background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%); }
        .warning-toast { background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%); }
        .scrollable::-webkit-scrollbar { width: 8px; }
        .scrollable::-webkit-scrollbar-track { background: rgba(255, 255, 255, 0.1); border-radius: 4px; }
        .scrollable::-webkit-scrollbar-thumb { background: rgba(255, 255, 255, 0.3); border-radius: 4px; }
        #suggestionBox {
            z-index: 40;
            position: absolute;
            left: 0; right: 0; top: 100%; 
            background: rgba(30, 30, 40, 0.98);
            border-radius: 0 0 1rem 1rem;
            border: 1px solid rgba(102,126,234,0.14);
            box-shadow: 0 8px 24px rgba(102, 126, 234, 0.10);
            max-height: 240px;
            overflow-y: auto;
            color: #fff;
            font-size: 1rem;
        }
        [data-theme='light'] #suggestionBox { background: #fff; color: #222; }
        #suggestionBox .suggestion {
            padding: 1rem 1.5rem; cursor: pointer; border-bottom: 1px solid rgba(102, 126, 234, 0.06);
        }
        #suggestionBox .suggestion:last-child { border-bottom: none; }
        #suggestionBox .suggestion:hover,
        #suggestionBox .suggestion.active { background: rgba(102, 126, 234, 0.10); }
    </style>
</head>
<body class="text-white flex flex-col min-h-screen" data-theme="dark">
    <!-- Animated Background -->
    <div class="bg-animation">
        <div class="floating-orb orb-1"></div>
        <div class="floating-orb orb-2"></div>
        <div class="floating-orb orb-3"></div>
    </div>

    <!-- Header -->
    <header class="glass sticky top-0 z-40 p-6 fade-in-up">
        <div class="flex justify-between items-center max-w-7xl mx-auto">
            <div class="flex items-center gap-4">
                <div class="w-14 h-14 rounded-full glass flex items-center justify-center">
                    <svg class="w-7 h-7 text-white" fill="currentColor" viewBox="0 0 24 24">
                        <path d="M12 2L2 7l10 5 10-5-10-5zM2 17l10 5 10-5M2 12l10 5 10-5"/>
                    </svg>
                </div>
                <div>
                    <h1 class="text-3xl font-bold bg-gradient-to-r from-white to-purple-200 bg-clip-text text-transparent">Placeholder.dev</h1>
                    <p class="text-sm text-white/60">Advanced Search Dashboard</p>
                </div>
            </div>
            <nav class="flex gap-3 items-center">
                <button onclick="switchTab('dashboard')" class="btn-secondary px-6 py-3 rounded-xl text-sm font-medium" id="tab-dashboard">Dashboard</button>
                <button onclick="switchTab('analytics')" class="btn-secondary px-6 py-3 rounded-xl text-sm font-medium" id="tab-analytics">Analytics</button>
                <button onclick="switchTab('labs')" class="btn-secondary px-6 py-3 rounded-xl text-sm font-medium" id="tab-labs">Labs</button>
                <button id="themeToggle" onclick="toggleTheme()" class="ml-3 px-4 py-2 rounded-xl btn-secondary flex items-center gap-2" title="Toggle theme">
                    <span id="themeIcon" class="text-xl">🌙</span>
                </button>
            </nav>
        </div>
    </header>

    <!-- Main Content -->
    <div class="flex-1 max-w-7xl mx-auto px-6 pb-6 w-full">
        <!-- Dashboard Tab -->
        <div id="dashboard-content" class="tab-content">
            <!-- Search Section -->
            <div class="flex flex-col justify-center items-center py-12 fade-in-up delay-100">
                <div class="text-center mb-12">
                    <h2 class="text-5xl md:text-6xl font-bold mb-6 bg-gradient-to-r from-white via-purple-200 to-pink-200 bg-clip-text text-transparent">Search Anything</h2>
                    <p class="text-xl text-white/80 max-w-2xl mx-auto">Your intelligent gateway to the web with real-time suggestions and bookmarks.</p>
                </div>
                <!-- Search Bar with Suggestions -->
                <div class="w-full max-w-4xl mb-8 relative">
                    <input type="text" id="searchInput" placeholder="Enter URL or search the web..." 
                        class="w-full h-20 px-8 pr-40 text-xl rounded-3xl search-input text-white placeholder-white/60 outline-none font-medium"
                        autocomplete="off"
                        oninput="handleSuggestions(event)" 
                        onkeydown="searchKeyDown(event)"
                        onfocus="handleSuggestions(event)"
                        onblur="hideSuggestions()"
                        />
                    <button onclick="handleSearch()" class="absolute right-3 top-3 h-14 px-10 btn-primary rounded-2xl text-white font-semibold flex items-center gap-3 text-lg">
                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"/>
                        </svg>
                        Search
                    </button>
                    <div id="suggestionBox" style="display:none;"></div>
                </div>
                <!-- Quick Actions -->
                <div class="flex flex-wrap gap-4 mb-8">
                    <button onclick="addBookmark()" class="btn-secondary px-8 py-4 rounded-2xl text-white font-medium flex items-center gap-3">
                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"/>
                        </svg>
                        Add Bookmark
                    </button>
                    <button onclick="clearBookmarks()" class="btn-secondary px-8 py-4 rounded-2xl text-white font-medium flex items-center gap-3">
                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
                        </svg>
                        Clear Bookmarks
                    </button>
                    <button onclick="showRandomBookmark()" class="btn-secondary px-8 py-4 rounded-2xl text-white font-medium flex items-center gap-3">
                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"/>
                        </svg>
                        Random Site
                    </button>
                </div>
            </div>
            <!-- Bookmarks Section -->
            <div class="glass rounded-3xl p-8 fade-in-up delay-200">
                <div class="flex justify-between items-center mb-6">
                    <div class="flex items-center gap-4">
                        <h3 class="text-2xl font-semibold">Quick Access</h3>
                        <span id="bookmarkCount" class="px-4 py-2 rounded-full bg-white/20 text-sm font-medium">0 bookmarks</span>
                    </div>
                    <button onclick="exportBookmarks()" class="btn-secondary px-6 py-3 rounded-xl text-sm">Export</button>
                </div>
                <div id="bookmarkGrid" class="bookmark-grid scrollable max-h-96"></div>
                <div id="emptyBookmarks" class="text-center py-16 text-white/60">
                    <div class="w-24 h-24 mx-auto mb-6 rounded-full bg-white/10 flex items-center justify-center">
                        <svg class="w-12 h-12 opacity-50" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 5a2 2 0 012-2h10a2 2 0 012 2v16l-7-3.5L5 21V5z"/>
                        </svg>
                    </div>
                    <h3 class="text-2xl font-semibold mb-2">No bookmarks yet</h3>
                    <p class="text-lg">Add some to get started!</p>
                </div>
            </div>
        </div>
        <!-- Analytics Tab -->
        <div id="analytics-content" class="tab-content hidden">
            <div class="grid grid-cols-1 md:grid-cols-2 gap-8 py-8">
                <div class="glass rounded-3xl p-8">
                    <h2 class="text-2xl font-semibold mb-6">Usage Analytics</h2>
                    <div class="h-64"><canvas id="usageChart"></canvas></div>
                </div>
                <div class="glass rounded-3xl p-8">
                    <h2 class="text-2xl font-semibold mb-6">Top Bookmarks</h2>
                    <div id="topBookmarksList" class="space-y-4 scrollable max-h-64"></div>
                </div>
            </div>
        </div>
        <!-- Labs Tab -->
        <div id="labs-content" class="tab-content hidden">
            <div class="glass rounded-3xl p-8">
                <h2 class="text-2xl font-semibold mb-8">Export Bookmarks</h2>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <button onclick="exportBookmarks('json')" class="btn-primary p-6 rounded-2xl text-left">
                        <h3 class="text-lg font-semibold mb-2">Export as JSON</h3>
                        <p class="text-white/70">Download your bookmarks as a JSON file</p>
                    </button>
                    <button onclick="exportBookmarks('html')" class="btn-primary p-6 rounded-2xl text-left">
                        <h3 class="text-lg font-semibold mb-2">Export as HTML</h3>
                        <p class="text-white/70">Download as browser-compatible HTML</p>
                    </button>
                </div>
                <div class="pt-10">
                    <button onclick="showFeaturePopup()" class="btn-secondary py-3 px-6 rounded-xl">Voice Search (Web Speech API)</button>
                </div>
            </div>
        </div>
    </div>
    <!-- Footer -->
    <footer class="glass mt-auto p-6">
        <div class="max-w-7xl mx-auto flex justify-between items-center">
            <p class="text-white/60">Placeholder.dev - Advanced Search Dashboard</p>
            <div class="flex items-center gap-4 text-sm text-white/60">
                <span id="footerBookmarkCount">0 bookmarks</span>
                <span>•</span>
                <span>Version 2.0</span>
            </div>
        </div>
    </footer>
    <!-- Add Bookmark Modal -->
    <div id="bookmarkModal" class="fixed inset-0 bg-black/50 backdrop-blur-sm hidden flex items-center justify-center p-4 z-50">
        <div class="glass rounded-3xl p-10 w-full max-w-lg">
            <div class="flex justify-between items-center mb-8">
                <h3 class="text-2xl font-semibold text-white">Add Bookmark</h3>
                <button onclick="closeModal()" class="text-white/60 hover:text-white">×</button>
            </div>
            <div class="space-y-6">
                <div>
                    <label class="block text-white/80 mb-3 font-medium">Bookmark Name</label>
                    <input type="text" id="bookmarkName" placeholder="Enter bookmark name..." 
                           class="w-full h-14 px-6 rounded-2xl search-input text-white placeholder-white/60 outline-none">
                </div>
                <div>
                    <label class="block text-white/80 mb-3 font-medium">URL</label>
                    <input type="text" id="bookmarkUrl" placeholder="Enter URL..." 
                           class="w-full h-14 px-6 rounded-2xl search-input text-white placeholder-white/60 outline-none">
                </div>
                <div class="flex gap-4 pt-6">
                    <button onclick="saveBookmark()" class="flex-1 btn-primary h-14 rounded-2xl text-white font-semibold">Save</button>
                    <button onclick="closeModal()" class="flex-1 btn-secondary h-14 rounded-2xl text-white font-medium">Cancel</button>
                </div>
            </div>
        </div>
    </div>
    <!-- Toast Notifications & Error Container -->
    <div id="errorContainer" class="fixed top-6 right-6 z-50 space-y-3"></div>
    <!-- Feature Popup Modal -->
    <div id="featurePopup" class="fixed inset-0 bg-black/60 backdrop-blur-sm hidden flex items-center justify-center z-50">
        <div class="glass rounded-3xl p-8 w-full max-w-md text-center">
            <h3 class="text-2xl font-bold mb-3">Coming Soon!</h3>
            <p class="mb-6">Voice input using the Web Speech API will be added later as a popup here.<br>Settings sync with Supabase, search history, and more features are planned!</p>
            <button onclick="closeFeaturePopup()" class="btn-secondary py-3 px-6 rounded-xl">OK</button>
        </div>
    </div>
    <script>
        // Theme
        function updateThemeIcon(theme) {
            document.getElementById('themeIcon').textContent = theme === 'dark' ? '🌙' : '☀️';
        }
        function setTheme(theme) {
            document.documentElement.setAttribute('data-theme', theme);
            localStorage.setItem('theme', theme);
            updateThemeIcon(theme);
        }
        function toggleTheme() {
            const current = document.documentElement.getAttribute('data-theme');
            setTheme(current === 'dark' ? 'light' : 'dark');
        }
        function loadTheme() {
            let theme = localStorage.getItem('theme');
            if (!theme) theme = window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light';
            setTheme(theme);
        }
        // Popup for features
        function showFeaturePopup() {
            document.getElementById("featurePopup").classList.remove("hidden");
        }
        function closeFeaturePopup() {
            document.getElementById("featurePopup").classList.add("hidden");
        }
        // Global variables
        let bookmarks = JSON.parse(localStorage.getItem('bookmarks') || '[]');
        let analytics = JSON.parse(localStorage.getItem('analytics') || '{"clicks": {}, "daily": {}}');
        let currentTab = 'dashboard';
        // Error handler
        function showToast(message, type = 'success') {
            const container = document.getElementById('errorContainer');
            const toast = document.createElement('div');
            toast.className = `glass rounded-2xl p-4 text-white max-w-sm ${type}-toast`;
            toast.innerHTML = `<span class="font-medium">${message}</span>`;
            container.appendChild(toast);
            setTimeout(() => container.removeChild(toast), 3000);
        }
        // Search Suggestions
        let suggestionIndex = -1;
        function handleSuggestions(e) {
            const input = document.getElementById('searchInput');
            const value = input.value.trim();
            const suggestionBox = document.getElementById('suggestionBox');
            if (!value) {
                suggestionBox.style.display = 'none';
                return;
            }
            // Suggest from bookmarks + google suggestions (mocked for demo)
            let suggestions = bookmarks
                .filter(b => b.name.toLowerCase().includes(value.toLowerCase()) || b.url.toLowerCase().includes(value.toLowerCase()))
                .map(b => ({text: b.name, url: b.url, type: 'bookmark'}));
            // Simple "fake" suggestions (in real app, use an API)
            const googleSuggestions = [
                value,
                value + " tutorial",
                value + " documentation",
                value + " github",
                value + " news"
            ].map(text => ({text, type: 'search'}));
            suggestions = suggestions.concat(googleSuggestions);
            suggestionBox.innerHTML = suggestions.slice(0, 8).map((s, i) =>
                `<div class="suggestion${i === suggestionIndex ? ' active' : ''}" 
                    onclick="selectSuggestion(${i})"
                    data-idx="${i}">${s.type === 'bookmark' ? '🔖' : '🔎'} ${s.text} ${s.url ? `<span class='text-xs text-gray-400'>${s.url}</span>` : ''}</div>`
            ).join('');
            suggestionBox.style.display = suggestions.length ? 'block' : 'none';
            window.suggestionsData = suggestions;
            suggestionIndex = -1;
        }
        function searchKeyDown(e) {
            const suggestionBox = document.getElementById('suggestionBox');
            const suggestions = window.suggestionsData || [];
            if (!suggestionBox || !suggestions.length) return;
            if (e.key === 'ArrowDown') {
                suggestionIndex = Math.min(suggestions.length - 1, suggestionIndex + 1);
                updateSuggestionActive();
                e.preventDefault();
            } else if (e.key === 'ArrowUp') {
                suggestionIndex = Math.max(0, suggestionIndex - 1);
                updateSuggestionActive();
                e.preventDefault();
            } else if (e.key === 'Enter') {
                if (suggestionIndex >= 0) {
                    selectSuggestion(suggestionIndex);
                    e.preventDefault();
                } else {
                    handleSearch();
                }
            }
        }
        function updateSuggestionActive() {
            const suggestionBox = document.getElementById('suggestionBox');
            const nodes = suggestionBox.querySelectorAll('.suggestion');
            nodes.forEach((n, i) => n.classList.toggle('active', i === suggestionIndex));
        }
        function selectSuggestion(idx) {
            const suggestions = window.suggestionsData || [];
            if (!suggestions[idx]) return;
            const s = suggestions[idx];
            if (s.type === 'bookmark') {
                openBookmark(s.url, bookmarks.find(b => b.url === s.url).id);
            } else {
                document.getElementById('searchInput').value = s.text;
                handleSearch();
            }
            hideSuggestions();
        }
        function hideSuggestions() {
            setTimeout(() => { // allow click event
                document.getElementById('suggestionBox').style.display = 'none';
                suggestionIndex = -1;
            }, 120);
        }
        // SEARCH: open in new tab, no loading.html
        function handleSearch() {
            const input = document.getElementById('searchInput');
            const query = input.value.trim();
            if (!query) return showToast('Please enter a search term', 'warning');
            let url = query.includes('.') && !query.includes(' ') ? 
                (query.startsWith('http') ? query : 'https://' + query) :
                'https://www.google.com/search?q=' + encodeURIComponent(query);
            window.open(url, '_blank');
            input.value = '';
            hideSuggestions();
            trackAnalytics('search');
        }
        // Tab switching
        function switchTab(tabName) {
            document.querySelectorAll('.tab-content').forEach(content => content.classList.add('hidden'));
            document.querySelectorAll('nav .btn-secondary').forEach(btn => btn.classList.remove('active'));
            document.getElementById(tabName + '-content').classList.remove('hidden');
            document.getElementById('tab-' + tabName).classList.add('active');
            currentTab = tabName;
            if (tabName === 'analytics') renderAnalytics();
        }
        // Bookmark management
        function addBookmark() {
            document.getElementById('bookmarkUrl').value = document.getElementById('searchInput').value;
            document.getElementById('bookmarkModal').classList.remove('hidden');
            document.getElementById('bookmarkName').focus();
        }
        function saveBookmark() {
            const name = document.getElementById('bookmarkName').value.trim();
            const url = document.getElementById('bookmarkUrl').value.trim();
            if (!name || !url) return showToast('Please fill in both fields', 'warning');
            const finalUrl = url.includes('.') && !url.includes(' ') ? 
                (url.startsWith('http') ? url : 'https://' + url) : url;
            const bookmark = {
                id: Date.now(),
                name: name,
                url: finalUrl,
                favicon: `https://www.google.com/s2/favicons?sz=64&domain=${new URL(finalUrl).hostname}`,
                created: new Date().toISOString(),
                clicks: 0
            };
            bookmarks.push(bookmark);
            analytics.clicks[bookmark.id] = 0;
            saveData();
            renderBookmarks();
            closeModal();
            showToast('Bookmark added successfully!');
        }
        function closeModal() {
            document.getElementById('bookmarkModal').classList.add('hidden');
            document.getElementById('bookmarkName').value = '';
            document.getElementById('bookmarkUrl').value = '';
        }
        // BOOKMARK: open in new tab, no loading.html
        function openBookmark(url, id) {
            window.open(url, '_blank');
            // Update analytics
            const bookmark = bookmarks.find(b => b.id === id);
            if (bookmark) {
                bookmark.clicks++;
                analytics.clicks[id] = bookmark.clicks;
                const today = new Date().toDateString();
                analytics.daily[today] = (analytics.daily[today] || 0) + 1;
                saveData();
                renderBookmarks();
            }
        }
        function showRandomBookmark() {
            if (bookmarks.length === 0) return showToast('No bookmarks available', 'warning');
            const random = bookmarks[Math.floor(Math.random() * bookmarks.length)];
            openBookmark(random.url, random.id);
        }
        function clearBookmarks() {
            if (!confirm("Are you sure you want to clear all bookmarks?")) return;
            bookmarks = [];
            analytics = {clicks:{}, daily:{}};
            saveData();
            renderBookmarks();
            renderAnalytics();
            showToast('All bookmarks cleared.', 'success');
        }
        function renderBookmarks() {
            const grid = document.getElementById('bookmarkGrid');
            const empty = document.getElementById('emptyBookmarks');
            if (bookmarks.length === 0) {
                grid.innerHTML = '';
                empty.classList.remove('hidden');
                updateBookmarkCount();
                return;
            }
            empty.classList.add('hidden');
            grid.innerHTML = bookmarks.map(bookmark => `
                <div class="bookmark-item glass rounded-2xl p-6 text-center">
                    <div class="w-16 h-16 mx-auto mb-4 rounded-2xl bg-white/10 flex items-center justify-center">
                        <img src="${bookmark.favicon}" alt="Favicon" class="w-10 h-10 rounded-lg" 
                            onerror="this.style.display='none'; this.nextElementSibling.style.display='block';">
                        <svg class="w-8 h-8 text-white/60 hidden" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1"/>
                        </svg>
                    </div>
                    <h3 class="text-white font-semibold text-base mb-2 truncate">${bookmark.name}</h3>
                    <p class="text-white/50 text-sm mb-4">${bookmark.clicks} clicks</p>
                    <button onclick="openBookmark('${bookmark.url}', ${bookmark.id})" 
                            class="w-full btn-secondary py-3 rounded-xl text-sm text-white/80 hover:text-white font-medium">Open</button>
                </div>
            `).join('');
            updateBookmarkCount();
        }
        function updateBookmarkCount() {
            const count = bookmarks.length;
            document.getElementById('bookmarkCount').textContent = `${count} bookmark${count !== 1 ? 's' : ''}`;
            document.getElementById('footerBookmarkCount').textContent = `${count} bookmark${count !== 1 ? 's' : ''}`;
        }
        // Export functionality
        function exportBookmarks(format = 'json') {
            if (bookmarks.length === 0) return showToast('No bookmarks to export', 'warning');
            let content, filename, mimeType;
            if (format === 'json') {
                content = JSON.stringify({ bookmarks, exportDate: new Date().toISOString() }, null, 2);
                filename = `bookmarks-${new Date().toISOString().split('T')[0]}.json`;
                mimeType = 'application/json';
            } else {
                content = `<!DOCTYPE NETSCAPE-Bookmark-file-1>
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=UTF-8">
<TITLE>Bookmarks</TITLE>
<H1>Bookmarks</H1>
<DL><p>
${bookmarks.map(b => `    <DT><A HREF="${b.url}">${b.name}</A>`).join('\n')}
</DL><p>`;
                filename = `bookmarks-${new Date().toISOString().split('T')[0]}.html`;
                mimeType = 'text/html';
            }
            const blob = new Blob([content], { type: mimeType });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = filename;
            a.click();
            URL.revokeObjectURL(url);
            showToast(`Bookmarks exported as ${format.toUpperCase()}`);
        }
        // Analytics
        function trackAnalytics(type) {
            const today = new Date().toDateString();
            analytics.daily[today] = (analytics.daily[today] || 0) + 1;
            saveData();
        }
        function renderAnalytics() {
            // Chart.js area
            const ctx = document.getElementById('usageChart').getContext('2d');
            const days = Object.keys(analytics.daily).slice(-7);
            const clickData = days.map(d => analytics.daily[d]);
            if (window.usageChart) window.usageChart.destroy();
            window.usageChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: days,
                    datasets: [{
                        label: 'Searches/Clicks',
                        data: clickData,
                        fill: true,
                        borderColor: '#a78bfa',
                        backgroundColor: 'rgba(167,139,250,0.15)',
                        pointBackgroundColor: '#a78bfa',
                        tension: 0.45,
                    }]
                },
                options: {
                    plugins: { legend: {display: false} },
                    scales: { x: { grid: { display:false } }, y:{ grid: {color:'#eee'}, beginAtZero:true } }
                }
            });
            document.getElementById('topBookmarksList').innerHTML = bookmarks
                .sort((a, b) => (b.clicks || 0) - (a.clicks || 0))
                .slice(0, 5)
                .map((bookmark, index) => `
                    <div class="flex items-center gap-4 p-4 rounded-xl bg-white/5">
                        <div class="w-8 h-8 rounded-lg bg-gradient-to-r from-purple-500 to-pink-500 flex items-center justify-center text-white font-bold text-sm">
                            ${index + 1}
                        </div>
                        <div class="flex-1">
                            <h4 class="font-semibold text-white truncate">${bookmark.name}</h4>
                            <p class="text-sm text-white/60">${bookmark.clicks} clicks</p>
                        </div>
                    </div>
                `).join('') || '<div class="text-center text-white/60 py-8">No bookmark data yet</div>';
        }
        // Data persistence
        function saveData() {
            localStorage.setItem('bookmarks', JSON.stringify(bookmarks));
            localStorage.setItem('analytics', JSON.stringify(analytics));
        }
        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            loadTheme();
            renderBookmarks();
            document.getElementById('searchInput').focus();
            // Keyboard shortcuts
            document.addEventListener('keydown', (e) => {
                if ((e.ctrlKey || e.metaKey) && e.key === 'k') {
                    e.preventDefault();
                    document.getElementById('searchInput').focus();
                }
                if ((e.ctrlKey || e.metaKey) && e.key === 'b') {
                    e.preventDefault();
                    addBookmark();
                }
                if ((e.ctrlKey || e.metaKey) && e.key === '1') {
                    e.preventDefault();
                    switchTab('dashboard');
                }
                if ((e.ctrlKey || e.metaKey) && e.key === '2') {
                    e.preventDefault();
                    switchTab('analytics');
                }
                if ((e.ctrlKey || e.metaKey) && e.key === '3') {
                    e.preventDefault();
                    switchTab('labs');
                }
            });
            // Activate tab on load
            switchTab('dashboard');
        });
    </script>
</body>
</html>
